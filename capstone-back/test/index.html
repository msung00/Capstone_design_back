<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>WebSocket Chat Test</title>
  <script src="https://cdn.socket.io/4.0.1/socket.io.min.js"></script>
</head>
<body>
  <h1>WebSocket Chat Test</h1>

  <div>
    <label>Room ID:</label>
    <input type="text" id="roomId" placeholder="Enter room ID" />
    <button onclick="joinRoom()">Join Room</button>
    <button onclick="leaveRoom()">Leave Room</button>
  </div>

  <div>
    <label>Message:</label>
    <input type="text" id="message" placeholder="Enter message" />
    <button onclick="sendMessage()">Send Message</button>
  </div>

  <h2>Messages</h2>
  <div id="messages"></div>

  <script>
    // WebSocket 서버에 연결
    const socket = io('http://localhost:3000/chat'); 

    // 서버에서 메시지를 수신하고 화면에 출력
    socket.on('receiveMessage', (message) => {
      const messagesDiv = document.getElementById('messages');
      const messageElement = document.createElement('p');
      messageElement.textContent = `Room: ${message.roomId}, Sender: ${message.sender}, Message: ${message.content}`;
      messagesDiv.appendChild(messageElement);
    });

    // 방에 참여하는 함수
    function joinRoom() {
      const roomId = document.getElementById('roomId').value;
      socket.emit('joinRoom', { room: roomId });
      console.log(`Joined room: ${roomId}`);
    }

    // 방에서 나가는 함수
    function leaveRoom() {
      const roomId = document.getElementById('roomId').value;
      socket.emit('leaveRoom', { room: roomId });
      console.log(`Left room: ${roomId}`);
    }

    // 메시지를 방으로 전송하는 함수
    function sendMessage() {
      const roomId = document.getElementById('roomId').value;
      const messageContent = document.getElementById('message').value;
      const messageData = {
        room: roomId,
        sender: 'User' + Math.floor(Math.random() * 100), // 고유한 사용자 이름
        message: messageContent,
      };
      socket.emit('sendMessage', messageData);
      console.log(`Sent message: ${messageContent} to room: ${roomId}`);
    }
  </script>
</body>
</html>
